(function(d){function j(a,b,c){this.wrap=d(a);this.c=d(b);this.co=d(c);this.ctrl=this.status=!1;this.minH=this.maxH=0}j.prototype={init:function(){var a=this;this.inner=this.wrap.find(".inner");this.maxH=this.inner.height();this.minH=this.wrap.find(".hd").height();this.wrap.css({position:"fixed",left:0,bottom:0});this.inner.css("height",this.minH);this.co.click(function(){a.wrap.css("display","none");return!1});this.c.click(function(){a.ctrl=!0;!0==a.status?a.hide():a.show();return!1});this.show();
window.setTimeout(function(){!0==a.status&&!1==a.ctrl&&a.hide()},3E4);d.browser.msie&&"6.0"==d.browser.version&&(a.wrap.css({position:"absolute",top:"150px",bottom:"auto"}),(new ChuteModel).init(a.wrap))},hide:function(){var a=this;this.inner.animate({height:a.minH},1E3,function(){a.c.attr("title","\u5c55\u5f00");a.c.removeClass("close").addClass("open");a.status=!1})},show:function(){var a=this;this.inner.animate({height:a.maxH},1E3,function(){a.c.attr("title","\u9690\u85cf");a.c.removeClass("open").addClass("close");
a.status=!0})}};var k={referrer:document.referrer,url:"",map:{google:"q",baidu:"wd",soso:"w",sogou:"query",youdao:"q",bing:"q",yahoo:"p"},charset:{google:"utf-8",baidu:"gbk",soso:"gbk",sogou:"gbk",youdao:"utf-8",bing:"utf-8",yahoo:"utf-8"},init:function(a){this.url=a+"?app=search&controller=index&action=tag&&jsoncallback=?";if(""!=this.referrer){var b=this.getSeachProvider(this.referrer),a=this.getChaset(this.referrer,b);""!=b&&(b=this.parseGet(this.referrer,this.map[b]),""!=b&&this.get(b,a))}},get:function(a,
b){var c=this;d.getJSON(c.url,{wd:a,charset:b,pagesize:10},function(a){a.data&&c.show(a.wd,a.data,a.url)})},getChaset:function(a,b){var c=this.parseGet(a,"ie");c||(c=this.charset[b]);return c},show:function(a,b,c){var i=d('<div class="pop-menu" id="popMenu"><div class="inner">\t\t\t\t\t<div class="hd"><h3 class="title">\u60a8\u53ef\u80fd\u611f\u5174\u8da3\u7684\u5185\u5bb9</h3><a href="#" class="close" title="\u9690\u85cf" id="switchE"></a><a href="#" class="closes" title="\u5173\u95ed" id="close"></a></div>\t\t\t\t\t<div class="bd"><ul class="list"></ul></div>\t\t\t\t\t<div class="fd"><a href="#" class="search-more">\u66f4\u591a<span></span>\u7684\u76f8\u5173\u5185\u5bb9 &gt&gt </a></div>\t\t\t\t</div></div>'),
h=i.find("ul.list"),f=i.find("a.search-more"),e="",g;for(g in b)e+='<li><a href="'+b[g].url+'">'+b[g].title+"</a></li>";h.append(e);f.find("span").html(a.substring(0,12));f.attr("href",c);i.appendTo(document.body);(new j("#popMenu","#switchE","#close")).init()},getSeachProvider:function(a){return 0<a.indexOf("www.google.com")?"google":0<a.indexOf("www.baidu.com")?"baidu":0<a.indexOf("www.soso.com")?"soso":0<a.indexOf("www.sogou.com")?"sogou":0<a.indexOf("www.youdao.com")?"youdao":0<a.indexOf("cn.bing.com")?
"bing":0<a.indexOf("search.cn.yahoo.com")?"yahoo":""},parseGet:function(a,b){var a=a.split("?"),c=[];if(!a[1])return"";for(var d=a[1].split("&"),h=!0,f=0;f<d.length;f++){var e=d[f].split("=");if(b){if(e[0]==b)return e[1];h=!1}else{var g={};g[e[0]]=e[1];c.push(g)}}return!1==h?"":c}};d(document).ready(function(){k.init(APP_URL)})})(jQuery);
