"use strict";!function(){var showClass=function(_options){this.v={type:1,catid:0,id:0,thumbs:"",programWrap:"#J_main_program",player:null,vodAPI:"https://web.cbg.cn/vod/getVideoUrl"};$.extend(true,this.v,_options);this.init()};showClass.prototype={init:function(){this.createProgramSlide()},createProgramSlide:function(){var _this=this;if($(_this.v["programWrap"]).length>0){jQuery(_this.v["programWrap"]).slide({mainCell:".bd ul",effect:"left",delayTime:800,vis:4,scroll:4,pnLoop:false,autoPage:true,trigger:"click",easing:"easeOutCubic"})}},createVideo:function(_wrap,_url,_videoType){var _this=this;if($(_wrap).length>0&&_url){var vodURL="";if(typeof _url==="string"){vodURL=_url}else if(typeof _url==="object"){if(_url.hd){vodURL=_url.hd}else if(_url.sd){vodURL=_url.sd}else if(_url.low){vodURL=_url.low}}if(vodURL){$.get(_this.v["vodAPI"],{url:vodURL},function(result){if(result.data.url){_this.v["player"]=new ckplayer({container:_wrap,variable:"player",autoplay:true,poster:_this.v["thumbs"],video:result.data.url,live:_videoType==="live"||_videoType==="replay"?true:false,html5m3u8:true});$(_wrap).show()}else{log("视频地址为空！")}})}}},flashPlayerPause:function(){var _this=this;if(_this.v["player"]){_this.v["player"].videoPause()}}};window.showClass=showClass}();
"use strict";!function(){var showArticleClass=function(_options){this.v={audio:{wrap:"#J_article_audio",url:"",object:null},video:{wrap:"#J_article_video",url:null},album:{wrap:"#J_article_album",data:[]},series:{type:0,data:[],play:0,wrap:"#J_article_series",videoWrap:"#J_article_series_video",videoPlayerWrap:"#J_article_series_video_player",videoSwitchWrap:"#J_article_series_video_switch",listWrap:"#J_article_series_list",listScrollWrap:"#J_article_series_list_scroll",timer:null,player:null},contentWrap:".article-content",getVideoAPI:"https://web.cbg.cn/vod/getVideoUrlList",timer:null,videoType:"vod"};$.extend(true,this.v,_options);this.init()};showArticleClass.prototype={init:function(){var _this=this;if(show.v["type"]===1||show.v["type"]===3){show.createVideo(_this.v.video["wrap"],_this.v.video["url"],_this.v["videoType"])}if(show.v["type"]===1||show.v["type"]===4){_this.createAudio()}if(show.v["type"]===1||show.v["type"]===5){_this.createAlbum()}if(show.v["type"]===6){_this.createSeries()}if(show.v["type"]===1){_this.changeContentSrc(true);_this.afterTenMinute();_this.onContentPlay()}},createAudio:function(){var _this=this;if($(_this.v.audio["wrap"]).length>0&&_this.v.audio["url"]){$.get(show.v["vodAPI"],{url:_this.v.audio["url"]},function(result){if(result.data.url){$(_this.v.audio["wrap"]).html('<audio src="'+result.data.url+'" preload="auto"></audio>').show();audiojs.events.ready(function(){_this.v.audio["object"]=audiojs.create($(_this.v.audio["wrap"]).find("audio").get(0),{})})}else{log("音频地址为空！")}})}},audioPause:function(){var _this=this;if(_this.v.audio["object"]){_this.v.audio["object"].pause()}},createAlbum:function(){var _this=this;if($(_this.v.album["wrap"]).length>0&&_this.v.album["data"].length>0){var html="";html+='<div class="album-image-md" id="J_album_image_md">';html+='<div class="album-image-bd">';html+='<img class="album-image" id="J_album_image">';html+="</div>";html+='<div class="album-image-ft" id="J_album_image_ft"></div>';html+='<ul class="album-image-nav hide" id="J_album_image_nav">';html+='<li class="album-image-nav-left-block" id="J_album_image_nav_left_block">';html+='<a class="album-image-btn-prev" id="J_album_image_btn_prev" href="#prev-image">‹</a>';html+="</li>";html+='<li class="album-image-nav-right-block" id="J_album_image_nav_right_block">';html+='<a class="album-image-btn-next" id="J_album_image_btn_next" href="#next-image">›</a>';html+="</li>";html+="</ul>";html+='<div class="album-image-loading-overlay hide" id="J_album_image_loading_overlay">';html+='<img src="'+albumPath+'loading.gif" alt="loading...">';html+="</div>";html+="</div>";html+='<div class="album-carousel" id="J_album_carousel">';html+='<a class="album-carousel-btn-prev" id="J_album_carousel_btn_prev" href="#prev-group">‹</a>';html+='<div class="album-carousel-zone" id="J_album_carousel_zone">';html+='<ul class="album-carousel-list img-load trans-none" id="J_album_carousel_list">';$.each(_this.v.album["data"],function(i,item){html+='<li class="album-carousel-thumb">';html+='<a class="image" href="'+item.img+'"><img src="'+item.img+'" alt="'+item.title+'"></a>';html+="</li>"});html+="</ul>";html+="</div>";html+='<a href="#next-group" class="album-carousel-btn-next" id="J_album_carousel_btn_next">›</a>';html+="</div>";$(_this.v.album["wrap"]).html(html).show();var showAlbum=new jQuery.Album}},createSeries:function(){var _this=this;if($(_this.v.series["wrap"]).length>0&&_this.v.series["data"].length>0){var html="";html+='<div class="series-video" id="J_article_series_video">';html+='<div class="series-video-player" id="J_article_series_video_player"></div>';html+='<div class="series-video-switch" id="J_article_series_video_switch">';html+='<span class="bg">';html+='<svg viewBox="0 0 10 60" width="10" height="60">';html+='<path d="M3.8,5.1C1.7,4.3,0.2,2.4,0,0h0v5v4v41v5v3.9c0.6-1.9,2.1-3.4,4-4v0c2.9-0.7,5-3.2,5-6.3v-37 C9,8.4,6.8,5.7,3.8,5.1z"></path>';html+="</svg>";html+="</span>";html+='<i class="icon icon-left">';html+='<svg viewBox="0 0 16 16" width="16" height="16">';html+='<path d="M6.427 8l3.284 3.284a1.01 1.01 0 0 1-1.427 1.427L4.29 8.716A1.003 1.003 0 0 1 3.995 8a1.005 1.005 0 0 1 .295-.717l3.994-3.994a1.01 1.01 0 0 1 1.427 1.427L6.427 8z"></path>';html+="</svg>";html+="</i>";html+='<i class="icon icon-right">';html+='<svg viewBox="0 0 16 16" width="16" height="16">';html+='<path d="M11.71 8.716L7.716 12.71a1.01 1.01 0 0 1-1.427-1.427L9.573 8 6.289 4.716a1.01 1.01 0 0 1 1.427-1.427l3.994 3.994c.198.198.296.458.295.717.001.259-.097.518-.295.716z"></path>';html+="</svg>";html+="</i>";html+="</div>";html+="</div>";html+='<div class="series-list" id="J_article_series_list">';html+='<div class="series-list-scroll" id="J_article_series_list_scroll">';html+=_this.v.series["type"]===0?_this.getSeriesListNumber():_this.getSeriesListText();html+="</div>";html+="</div>";$(_this.v.series["wrap"]).html(html).show();$(".J_lazyImg").lazyLoad();_this.setSeriesLoad();_this.setSeriesListClick();_this.setSeriesListSwitch()}},getSeriesListNumber:function(){var _this=this;var html="";html+='<ul class="series-list-number">';$.each(_this.v.series["data"],function(i,item){html+='<li><a href="javascript:;">'+(i+1)+"</a></li>"});html+="</ul>";return html},getSeriesListText:function(){var _this=this;var html="";html+='<ul class="series-list-text">';$.each(_this.v.series["data"],function(i,item){html+="<li>";if(item.img){html+='<a class="image" href="javascript:;" title="'+item.title+'">';html+='<img class="J_lazyImg" data-src="'+item.img+'">';if(item.duration){html+='<span class="tag">'+_this.getSeriesFormatDuration(item.duration)+"</span>"}html+="</a>"}html+='<p class="title"><a href="javascript:;" title="'+item.title+'">'+item.title+"</a></p>";html+="</li>"});html+="</ul>";return html},setSeriesLoad:function(){var _this=this;if(_this.getSeriesQueryString("play")){_this.v.series["play"]=parseInt(_this.getSeriesQueryString("play"))-1}$(_this.v.series["listWrap"]).find("li").eq(_this.v.series["play"]).addClass("on");$(_this.v.series["listScrollWrap"]).scroll(function(){$(".J_lazyImg").lazyLoad()});_this.setSeriesPlay()},setSeriesPlay:function(){var _this=this;_this.setTextSeriesScrollCenter();$(".title-sub").html(_this.v.series["data"][_this.v.series["play"]].title);try{var url=window.location.href.split("?")[0]+"?play="+(_this.v.series["play"]+1);window.history.pushState(null,null,url)}catch(err){}_this.setSeriesPlayVideo()},setSeriesPlayVideo:function(){var _this=this;$.get(show.v["vodAPI"],{url:_this.v.series["data"][_this.v.series["play"]].url},function(result){if(result.data.url){var videoObject={container:_this.v.series["videoPlayerWrap"],variable:"player",autoplay:true,poster:_this.v.series["data"][_this.v.series["play"]].image,video:result.data.url};_this.v.series["player"]=new ckplayer(videoObject);_this.setSeriesAutoNextPlay()}else{log("视频地址为空！")}})},setSeriesListSwitch:function(){var _this=this;$(document).on("click",_this.v.series["videoSwitchWrap"],function(){if($(_this.v.series["videoWrap"]).hasClass("series-video-full")){$(this).find(".icon-right").show();$(this).find(".icon-left").hide();$(_this.v.series["videoWrap"]).removeClass("series-video-full");$(_this.v.series["listWrap"]).show()}else{$(this).find(".icon-right").hide();$(this).find(".icon-left").show();$(_this.v.series["videoWrap"]).addClass("series-video-full");$(_this.v.series["listWrap"]).hide()}if(_this.v.series["timer"]){clearTimeout(_this.v.series["timer"])}_this.v.series["timer"]=setTimeout(function(){var myEvent=new Event("resize");window.dispatchEvent(myEvent)},500)})},setSeriesListClick:function(){var _this=this;$(document).on("click",_this.v.series["listWrap"]+" li",function(){$(this).addClass("on").siblings().removeClass("on");_this.v.series["play"]=$(this).index();_this.setSeriesPlay()})},setSeriesAutoNextPlay:function(){var _this=this;if(_this.v.series["player"]){_this.v.series["player"].addListener("ended",function(){if(_this.v.series["data"].length-_this.v.series["play"]===1){_this.v.series["play"]=0}else{_this.v.series["play"]=_this.v.series["play"]+1}$(_this.v.series["listWrap"]).find("li").eq(_this.v.series["play"]).addClass("on").siblings().removeClass("on");_this.setTextSeriesScrollCenter();_this.setSeriesPlay()})}},setTextSeriesScrollCenter:function(){var _this=this;try{var listOuterHeight=$(_this.v.series["listScrollWrap"]).height(),liHeight=_this.v.series["type"]===1?69:40,lisHeight=_this.v.series["type"]===1?$(_this.v.series["listScrollWrap"]+" .series-list-text").height():$(_this.v.series["listScrollWrap"]+" .series-list-number").height(),fixedNumber=_this.v.series["type"]===1?3:6,scrollRange=lisHeight-listOuterHeight,curTopHeight=0;if(scrollRange>0){curTopHeight=$(_this.v.series["listWrap"]+" li.on").get(0).offsetTop-10;if(liHeight*fixedNumber>=curTopHeight){$(_this.v.series["listScrollWrap"]).scrollTop(0)}else{if(scrollRange-(curTopHeight-liHeight*fixedNumber)>0){$(_this.v.series["listScrollWrap"]).scrollTop(curTopHeight-liHeight*fixedNumber)}else{$(_this.v.series["listScrollWrap"]).scrollTop(scrollRange)}}}}catch(err){}},getSeriesFormatDuration:function(_duration){var hour=parseInt(_duration/3600),minute=parseInt(_duration%3600/60),second=_duration%60,str="";str+=hour===0?"":hour<10?"0"+hour+":":hour+":";str+=minute<10?"0"+minute+":":minute+":";str+=second<10?"0"+second:second;return str},getSeriesQueryString:function(_name){var reg=new RegExp("(^|&)"+_name+"=([^&]*)(&|$)"),r=decodeURIComponent(window.location.search).substr(1).match(reg);return r!=null?unescape(r[2]):null},changeContentSrc:function(_flag){var _this=this,videoElems=$(_this.v.contentWrap).find("video"),audioElems=$(_this.v.contentWrap).find("audio"),videoURLArr=[],audioURLArr=[],URLArr=[];if(videoElems.length>0){for(var i=0;i<videoElems.length;i++){var videoItem=videoElems[i],videoSrc=$(videoItem).attr("src"),sourceElem=$(videoItem).find("source"),sourceSrc=$(sourceElem).attr("src"),src=videoSrc||sourceSrc||"";if(src){videoURLArr.push(src)}}}if(audioElems.length>0){for(var i=0;i<audioElems.length;i++){var audioItem=audioElems[i],audioSrc=$(audioItem).attr("src");if(audioSrc){audioURLArr.push(audioSrc)}}}URLArr=videoURLArr.concat(audioURLArr);if(URLArr.length>0){$.ajax({url:_this.v.getVideoAPI,type:"GET",data:{urls:URLArr.join(",")},dataType:"json",success:function(json){if(json&&json.code==0&&json.data&&json.data.length>0){var vArr=json.data.slice(0,videoURLArr.length),aArr=json.data.slice(videoURLArr.length),vLen=0,aLen=0;for(var i=0;i<videoElems.length;i++){var videoItem=videoElems[i],videoSrc=$(videoItem).attr("src"),sourceElem=$(videoItem).find("source"),sourceSrc=$(sourceElem).attr("src"),src=videoSrc||sourceSrc||"";if(src){if(_flag||videoItem.paused){$(videoItem).attr("src",vArr[vLen]);videoItem.src=vArr[vLen];if(sourceElem.length>0){$(videoItem).html("")}}vLen++}}for(var i=0;i<audioElems.length;i++){var audioItem=audioElems[i],audioSrc=$(audioItem).attr("src");if(audioSrc){if(_flag||audioItem.paused){$(audioItem).attr("src",aArr[aLen]);audioItem.src=aArr[aLen]}aLen++}}}else{console.log("未获取到防盗链地址")}},error:function(){console.log("接口请求失败，URL:"+_this.v.getVideoAPI)}})}},afterTenMinute:function(){var _this=this;_this.v.timer=setInterval(function(){_this.changeContentSrc(false)},6e5)},onContentPlay:function(){var _this=this,videoElems=$(_this.v.contentWrap).find("video"),audioElems=$(_this.v.contentWrap).find("audio");videoElems.on("play",function(event){show.flashPlayerPause();_this.audioPause();var curVideo=event.target;$.each(videoElems,function(i,item){if(curVideo!==item){item.pause()}});$.each(audioElems,function(i,item){item.pause()})});audioElems.on("play",function(event){show.flashPlayerPause();_this.audioPause();var curAudio=event.target;$.each(videoElems,function(i,item){item.pause()});$.each(audioElems,function(i,item){if(curAudio!==item){item.pause()}})})},contentPause:function(){var _this=this,videoElems=$(_this.v.contentWrap).find("video"),audioElems=$(_this.v.contentWrap).find("audio");$.each(videoElems,function(i,item){item.pause()});$.each(audioElems,function(i,item){item.pause()})}};window.showArticleClass=showArticleClass}();